(function(e){e.wpProQuizFront=function(i,t){function o(){var e=0,i=-1,t=0,o=!1;this.questionStart=function(t){-1!=i&&this.questionStop(),i=t,e=+new Date},this.questionStop=function(){-1!=i&&(p[i].time+=Math.round((new Date-e)/1e3),i=-1)},this.startQuiz=function(){o&&this.stopQuiz(),t=+new Date,o=!0},this.getQuizStart=function(){if(o)return t},this.stopQuiz=function(){o&&(quizEndTimer=+new Date,p.comp.quizTime+=Math.round((quizEndTimer-t)/1e3),p.comp.quizEndTimestamp=quizEndTimer,p.comp.quizStartTimestamp=t,o=!1)},this.init=function(){}}function n(i,t,o,n,u){u=u||!1;if("single"==i.type||"multiple"==i.type)n.children().each(function(i){var n=e(this),r=n.attr("data-pos");if(null!=t[r]){var d=t[r];1==d&&(e(".wpProQuiz_questionInput",n).prop("checked","checked"),u&&(o.find(".wpProQuiz_questionInput").attr("disabled","disabled"),o.find(".wpProQuiz_questionInput").css("pointer-events","none"),s(o)),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}}))}});else if("free_answer"==i.type)n.children().each(function(i){e(this);e(".wpProQuiz_questionInput",this).val(t),u&&(e(".wpProQuiz_questionInput",this).attr("disabled","disabled"),e(".wpProQuiz_questionInput",this).css("pointer-events","none"),s(o))}),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}});else if("sort_answer"==i.type)jQuery.each(t,function(i,t){var r=e('li.wpProQuiz_questionListItem[data-pos="'+t+'"]',n),a=e("div.wpProQuiz_sortable",r);e(a).text();jQuery(n).append(r),u&&(jQuery(n).sortable(),jQuery(n).sortable("disable"),s(o))}),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}});else if("matrix_sort_answer"==i.type)jQuery.each(t,function(i,t){var r=e('.wpProQuiz_matrixSortString .wpProQuiz_sortStringList li[data-pos="'+i+'"]',o),a=e('li.wpProQuiz_questionListItem[data-pos="'+t+'"] ul.wpProQuiz_maxtrixSortCriterion',n);jQuery(r).appendTo(a),u&&(jQuery(a).sortable(),jQuery(a).sortable("disable"),s(o))}),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}});else if("cloze_answer"==i.type)jQuery('span.wpProQuiz_cloze input[type="text"]',n).each(function(i){void 0!==t[i]&&(e(this).val(t[i]),u&&(e(this).attr("disabled","disabled"),s(o)))}),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}});else if("assessment_answer"==i.type)e('input.wpProQuiz_questionInput[value="'+t+'"]',n).attr("checked","checked"),u&&(e('input.wpProQuiz_questionInput[value="'+t+'"]',n).attr("disabled","disabled"),s(o)),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}});else if("essay"==i.type)if(n.find("#uploadEssayFile_"+i.id).length){var d=n.find("#uploadEssayFile_"+i.id);e(d).val(t),e("<p>"+r(t)+"</p>").insertAfter(d),u&&(n.find('form[name="uploadEssay"]').css("pointer-events","none"),s(o)),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}else n.find(".wpProQuiz_questionEssay").length&&(n.find(".wpProQuiz_questionEssay").html(t),u&&(n.find(".wpProQuiz_questionEssay").attr("disabled","disabled"),s(o)),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}}));u&&c.methode.setCheckedStatusFromData(i,o,n)}function s(e){e.find(C.check).hide(),e.find(C.tip).hide(),e.find(C.skip).hide(),e.find(C.next).show(),e.find(C.next).attr("data-question-lock",!0)}function r(e){return null!=e?e.split("/").reverse()[0]:""}var a=e(i),u=t,d={},c=this,p=new Object,l=new Object,h=0,f=null,m=[],_="",w=!1,v=1,Q=0,z=null,P="",q=!1,g="",y=0,k=!1,x={},S={randomAnswer:0,randomQuestion:0,disabledAnswerMark:0,checkBeforeStart:0,preview:0,cors:0,isAddAutomatic:0,quizSummeryHide:0,skipButton:0,reviewQustion:0,autoStart:0,forcingQuestionSolve:0,hideQuestionPositionOverview:0,formActivated:0,maxShowQuestion:0,sortCategories:0},b={isQuizStart:0,isLocked:0,loadLock:0,isPrerequisite:0,isUserStartLocked:0},C={check:'input[name="check"]',next:'input[name="next"]',tip:'input[name="tip"]',questionList:".wpProQuiz_questionList",skip:'input[name="skip"]',singlePageLeft:'input[name="wpProQuiz_pageLeft"]',singlePageRight:'input[name="wpProQuiz_pageRight"]'},I={back:a.find('input[name="back"]'),next:a.find(C.next),quiz:a.find(".wpProQuiz_quiz"),questionList:a.find(".wpProQuiz_list"),results:a.find(".wpProQuiz_results"),sending:a.find(".wpProQuiz_sending"),quizStartPage:a.find(".wpProQuiz_text"),timelimit:a.find(".wpProQuiz_time_limit"),toplistShowInButton:a.find(".wpProQuiz_toplistShowInButton"),listItems:e()},j={token:"",isUser:0},T={START:0,END:1},L={counter:u.timelimit,intervalId:0,instance:{},timer_cookie:"ldadv-time-limit-"+u.user_id+"-"+u.quizId,stop:function(){this.counter&&(e.removeCookie(this.timer_cookie),window.clearInterval(this.intervalId),I.timelimit.hide())},start:function(){if(this.counter){this.timer_cookie,e.cookie.raw=!0;var i=1e3*this.counter,t=jQuery.cookie(this.timer_cookie),o=0;if(o=t||this.counter,"1"===u.quiz_resume_enabled&&void 0!==u.quiz_resume_data){var n=JSON.parse(u.quiz_resume_data);n[this.timer_cookie]&&(o=n[this.timer_cookie])}var s=1e3*o,r=I.timelimit.find("span").text(c.methode.parseTime(o)),a=I.timelimit.find(".wpProQuiz_progress");I.timelimit.show();var d=+new Date;this.intervalId=window.setInterval(function(){var o=+new Date-d,n=s-o;o>=500&&(t=n/1e3,r.text(c.methode.parseTime(Math.ceil(t))),e.cookie(this.timer_cookie,t)),a.css("width",n/i*100+"%"),n<=0&&(this.stop(),c.methode.finishQuiz(!0))}.bind(this),16),"1"!==u.quiz_resume_enabled||q||c.methode.startCookieSendTimer()}}},E=new function(){function i(e){}function t(e){var i="",t=w[e];t.correct?i="wpProQuiz_reviewQuestionSolvedCorrect":t.incorrect?i="wpProQuiz_reviewQuestionSolvedIncorrect":!0===t.solved||!1===t.solved?i="wpProQuiz_reviewQuestionSolved":t.review?i="wpProQuiz_reviewQuestionReview":t.skip&&(i="wpProQuiz_reviewQuestionSkip"),p.eq(e).removeClass("wpProQuiz_reviewQuestionSolved"),p.eq(e).removeClass("wpProQuiz_reviewQuestionReview"),p.eq(e).removeClass("wpProQuiz_reviewQuestionSkip"),""!=i&&p.eq(e).addClass(i)}function o(e){e.preventDefault();var i=e.pageY-h;i<0&&(i=0),i>l&&(i=l);var t=f*i;d.attr("style","margin-top: "+-t+"px !important"),r.css({top:i})}function n(i){i.preventDefault(),e(document).unbind(".scrollEvent")}var s=[],r=[],d=[],p=[],l=0,h=0,f=0,m=0,_=0,w=[];this.init=function(){s=a.find(".wpProQuiz_reviewQuestion"),r=s.find("div"),d=s.find("ol"),p=d.children(),2!=u.mode&&(e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-correct").hide(),e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-incorrect").hide()),r.on("mousedown",function(i){i.preventDefault(),i.stopPropagation(),h=i.pageY-r.offset().top+m,e(document).on("mouseup.scrollEvent",n),e(document).on("mousemove.scrollEvent",o)}),p.on("click",function(i){c.methode.showQuestion(e(this).index())}),a.on("questionSolved",function(e){w[e.values.index].solved=e.values.solved,t(e.values.index)}),a.on("questionSolvedCorrect",function(e){w[e.values.index].correct=!0,t(e.values.index)}),a.on("questionSolvedIncorrect",function(e){w[e.values.index].incorrect=!0,t(e.values.index)}),a.on("changeQuestion",function(e){if("undefined"!=e.values.item[0]){e.values.item[0];c.methode.setupMatrixSortHeights()}p.removeClass("wpProQuiz_reviewQuestionTarget"),p.eq(e.values.index).addClass("wpProQuiz_reviewQuestionTarget"),i(e.values.index)}),a.on("skipQuestion",function(e){w[e.values.index].skip=!w[e.values.index].skip,t(e.values.index)}),a.on("reviewQuestion",function(e){w[e.values.index].review=!w[e.values.index].review,t(e.values.index)})},this.show=function(e){if(S.reviewQustion&&s.parent().show(),a.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").show(),!e){d.attr("style","margin-top: 0px !important"),r.css({top:0});var i=d.outerHeight(),t=s.height();l=t-r.height(),h=0,_=i-t,f=_/l,this.reset(),i>100&&r.show(),m=r.offset().top}},this.hide=function(){s.parent().hide()},this.toggle=function(){if(S.reviewQustion){e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-current").hide(),e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-review").hide(),e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-answered").hide(),e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-correct").show(),e(".wpProQuiz_reviewLegend li.learndash-quiz-review-legend-item-incorrect").show(),s.parent().toggle(),p.removeClass("wpProQuiz_reviewQuestionTarget"),a.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").hide(),d.attr("style","margin-top: 0px !important"),r.css({top:0});var i=d.outerHeight(),t=s.height();l=t-r.height(),h=0,_=i-t,f=_/l,i>100&&r.show(),m=r.offset().top}},this.reset=function(){for(var e=0,i=p.length;e<i;e++)w[e]={};p.removeClass("wpProQuiz_reviewQuestionTarget"),p.removeClass("wpProQuiz_reviewQuestionSolved"),p.removeClass("wpProQuiz_reviewQuestionReview")}},A=new o,D=function(i,t,o,n,s){null==s&&(s=!0);var r={},a={singleMulti:function(){var i=n.find(".wpProQuiz_questionInput");1==s&&n.find(".wpProQuiz_questionInput").attr("disabled","disabled"),jQuery(".wpProQuiz_questionListItem",n).each(function(t){var o=e(this),n=o.attr("data-pos");void 0!==n&&(r[n]=i.eq(t).is(":checked"))})},sort_answer:function(){var e=n.children("li.wpProQuiz_questionListItem"),i=0;e.each(function(e,t){var o=jQuery(t).data("pos");void 0!==o&&(r[i]=o,i++)}),1==s&&(n.sortable(),n.sortable("disable"))},matrix_sort_answer:function(){var i=n.children();new Array;statistcAnswerData={0:-1},i.each(function(t){var o=e(this),n=o.find(".wpProQuiz_maxtrixSortCriterion"),s=n.children();if(s.length){var r=s.attr("data-pos");statistcAnswerData[t]=i[r].getAttribute("data-pos")}else statistcAnswerData[t]=""}),r=statistcAnswerData,1==s&&(o.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable(),o.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable("disable"))},free_answer:function(){var e=n.children(),i=e.find(".wpProQuiz_questionInput").val();1==s&&e.find(".wpProQuiz_questionInput").attr("disabled","disabled"),r=i},cloze_answer:function(){r={},n.find(".wpProQuiz_cloze").each(function(i,t){var o=e(this),n=o.children(),a=n.eq(0),u=(n.eq(1),c.methode.cleanupCurlyQuotes(a.val()));r[i]=u,1==s&&a.attr("disabled","disabled")})},assessment_answer:function(){correct=!0;var i=n.find(".wpProQuiz_questionInput");1==s&&n.find(".wpProQuiz_questionInput").attr("disabled","disabled");var t=0;i.filter(":checked").each(function(){t+=parseInt(e(this).val())}),r=t},essay:function(){var e=o.find("ul.wpProQuiz_questionList").data("question_id");1==s&&n.find(".wpProQuiz_questionEssay").attr("disabled","disabled");var i=n.find(".wpProQuiz_questionEssay").val(),t=n.find("#uploadEssayFile_"+e).val();void 0!==i&&(r=i),void 0!==t&&(r=t)}};return a[i](),{response:r}},O={funcs:{isEmpty:function(e){return e=e.trim(),!e||0===e.length}},typeConst:{TEXT:0,TEXTAREA:1,NUMBER:2,CHECKBOX:3,EMAIL:4,YES_NO:5,DATE:6,SELECT:7,RADIO:8},checkForm:function(){var i=!0,t=this;return a.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var o=e(this),n=1==o.data("required"),s=o.data("type"),r=!0,a=o.val().trim();switch(s){case t.typeConst.TEXT:case t.typeConst.TEXTAREA:case t.typeConst.SELECT:n&&(r=!t.funcs.isEmpty(a));break;case t.typeConst.NUMBER:!n&&t.funcs.isEmpty(a)||(r=!t.funcs.isEmpty(a)&&!isNaN(a));break;case t.typeConst.EMAIL:!n&&t.funcs.isEmpty(a)||(r=!t.funcs.isEmpty(a)&&new RegExp(/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/).test(a));break;case t.typeConst.CHECKBOX:n&&(r=o.is(":checked"));break;case t.typeConst.YES_NO:case t.typeConst.RADIO:n&&(r=void 0!==o.find('input[type="radio"]:checked').val());break;case t.typeConst.DATE:var u=0,d=0;o.find("select").each(function(){u++,d+=t.funcs.isEmpty(e(this).val())?0:1}),(n||d>0)&&(r=u==d)}r?o.siblings(".wpProQuiz_invalidate").hide():(i=!1,o.siblings(".wpProQuiz_invalidate").show())}),i},getFormData:function(){var i={},t=this;return a.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var o=e(this),n=o.data("form_id"),s=o.data("type");switch(s){case t.typeConst.TEXT:case t.typeConst.TEXTAREA:case t.typeConst.SELECT:case t.typeConst.NUMBER:case t.typeConst.EMAIL:i[n]=o.val();break;case t.typeConst.CHECKBOX:i[n]=o.is(":checked")?1:0;break;case t.typeConst.YES_NO:case t.typeConst.RADIO:i[n]=o.find('input[type="radio"]:checked').val();break;case t.typeConst.DATE:i[n]={day:o.find('select[name="wpProQuiz_field_'+n+'_day"]').val(),month:o.find('select[name="wpProQuiz_field_'+n+'_month"]').val(),year:o.find('select[name="wpProQuiz_field_'+n+'_year"]').val()}}}),i},saveFormDataToCookie:function(){var i={},t=this;a.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var o=e(this),n=o.data("form_id");if(void 0!==n){var s=o.data("type");switch(i.id=n,s){case t.typeConst.TEXT:case t.typeConst.TEXTAREA:case t.typeConst.SELECT:case t.typeConst.NUMBER:case t.typeConst.EMAIL:i.value=o.val(),i.type=s;break;case t.typeConst.CHECKBOX:i.value=o.is(":checked")?1:0,i.type=s;break;case t.typeConst.YES_NO:case t.typeConst.RADIO:i.value=o.find('input[type="radio"]:checked').val(),i.type=s;break;case t.typeConst.DATE:i.value={day:o.find('select[name="wpProQuiz_field_'+n+'_day"]').val(),month:o.find('select[name="wpProQuiz_field_'+n+'_month"]').val(),year:o.find('select[name="wpProQuiz_field_'+n+'_year"]').val()},i.type=s}c.methode.CookieSaveResponse("formData"+i.id,i.id,i.type,i.value)}})},setFormDataFromServer:function(){if("1"===u.quiz_resume_enabled&&null!=u.quiz_resume_data){var i=JSON.parse(u.quiz_resume_data),t=this;a.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var o=e(this),n=o.data("form_id"),s=o.data("type"),r="formData"+n;if(i[r]&&i[r].type===s)switch(s){case t.typeConst.TEXT:case t.typeConst.TEXTAREA:case t.typeConst.SELECT:case t.typeConst.NUMBER:case t.typeConst.EMAIL:o.val(i[r].value);break;case t.typeConst.CHECKBOX:i[r].value&&o.attr("checked",!0);break;case t.typeConst.YES_NO:case t.typeConst.RADIO:i[r].value&&o.find('input[type="radio"][value="'+i[r].value+'"]').attr("checked",!0);break;case t.typeConst.DATE:o.find('select[name="wpProQuiz_field_'+n+'_day"]').val(i[r].value.day),o.find('select[name="wpProQuiz_field_'+n+'_month"]').val(i[r].value.month),o.find('select[name="wpProQuiz_field_'+n+'_year"]').val(i[r].value.year)}})}}},R=function(i){a.find(".wpProQuiz_questionList").each(function(){var t=e(this),o=t.data("question_id"),n=t.data("type"),s={};if("single"==n||"multiple"==n)t.find(".wpProQuiz_questionListItem").each(function(){s[e(this).attr("data-pos")]=+e(this).find(".wpProQuiz_questionInput").is(":checked")});else if("free_answer"==n)s[0]=t.find(".wpProQuiz_questionInput").val();else{if("sort_answer"==n)return!0;if("matrix_sort_answer"==n)return!0;if("cloze_answer"==n){var r=0;t.find(".wpProQuiz_cloze input").each(function(){s[r++]=e(this).val()})}else if("assessment_answer"==n)s[0]="",t.find(".wpProQuiz_questionInput:checked").each(function(){s[e(this).data("index")]=e(this).val()});else if("essay"==n)return}i[o].data=s})};c.methode={parseBitOptions:function(){if(u.bo){S.randomAnswer=1&u.bo,S.randomQuestion=2&u.bo,S.disabledAnswerMark=4&u.bo,S.checkBeforeStart=8&u.bo,S.preview=16&u.bo,S.isAddAutomatic=64&u.bo,S.reviewQustion=128&u.bo,S.quizSummeryHide=256&u.bo,S.skipButton=512&u.bo,S.autoStart=1024&u.bo,S.forcingQuestionSolve=2048&u.bo,S.hideQuestionPositionOverview=4096&u.bo,S.formActivated=8192&u.bo,S.maxShowQuestion=16384&u.bo,S.sortCategories=32768&u.bo;var e=32&u.bo;e&&null!=jQuery.support&&null!=jQuery.support.cors&&0==jQuery.support.cors&&(S.cors=e)}},setClozeStyle:function(){a.find(".wpProQuiz_cloze input").each(function(){for(var i=e(this),t="",o=i.data("wordlen"),n=0;n<o;n++)t+="w";var s=e(document.createElement("span")).css("visibility","hidden").text(t).appendTo(e("body")),r=s.width();s.remove(),i.width(r+5)})},parseTime:function(e){var i=parseInt(e%60),t=parseInt(e/60%60),o=parseInt(e/3600%24);return i=(i>9?"":"0")+i,t=(t>9?"":"0")+t,o=(o>9?"":"0")+o,o+":"+t+":"+i},cleanupCurlyQuotes:function(e){return e=e.replace(/\u2018/,"'"),e=e.replace(/\u2019/,"'"),e=e.replace(/\u201C/,'"'),e=e.replace(/\u201D/,'"'),e.trim()},resetMatrix:function(i){i.each(function(){var i=e(this),t=i.find(".wpProQuiz_sortStringList");i.find(".wpProQuiz_sortStringItem").each(function(){t.append(e(this))})})},marker:function(e,i){S.disabledAnswerMark||(!0===i?e.addClass("wpProQuiz_answerCorrect"):!1===i?e.addClass("wpProQuiz_answerIncorrect"):e.addClass(i))},startQuiz:function(i){if(b.loadLock)b.isQuizStart=1;else{if(b.isQuizStart=0,b.isLocked)return I.quizStartPage.hide(),void a.find(".wpProQuiz_lock").show();if(b.isPrerequisite)return I.quizStartPage.hide(),void a.find(".wpProQuiz_prerequisite").show();if(b.isUserStartLocked)return I.quizStartPage.hide(),void a.find(".wpProQuiz_startOnlyRegisteredUser").show();if(S.maxShowQuestion&&!i){if(u.formPos==T.START&&!O.checkForm())return;return I.quizStartPage.hide(),a.find(".wpProQuiz_loadQuiz").show(),void c.methode.loadQuizDataAjax(!0)}if(!S.formActivated||u.formPos!=T.START||O.checkForm()){switch(c.methode.loadQuizData(),void 0!==u.quiz_resume_data&&(x=JSON.parse(u.quiz_resume_data)),S.randomQuestion&&jQuery.isEmptyObject(x)&&!x.randomQuestions&&c.methode.random(I.questionList,"question"),S.randomAnswer&&c.methode.random(a.find(C.questionList)),S.sortCategories&&c.methode.sortCategories(),c.methode.random(a.find(".wpProQuiz_sortStringList")),a.find(".wpProQuiz_listItem").each(function(i,t){var o=e(this);o.find(".wpProQuiz_question_page span:eq(0)").text(i+1),o.find("> h5 span").text(i+1),o.find(".wpProQuiz_questionListItem").each(function(i,t){e(this).find("> span:not(.wpProQuiz_cloze)").text(i+1+". ")})}),I.next=a.find(C.next),u.mode){case 3:a.find('input[name="checkSingle"]').show();break;case 2:a.find(C.check).show(),!S.skipButton&&S.reviewQustion&&a.find(C.skip).show();break;case 1:a.find('input[name="back"]').slice(1).show();case 0:I.next.show()}(S.hideQuestionPositionOverview||3==u.mode)&&a.find(".wpProQuiz_question_page").hide();var o=I.next.last();_=o.val(),o.val(u.lbn);var n=I.questionList.children();if(I.listItems=a.find(".wpProQuiz_list > li"),3===u.mode&&"number"!=typeof x.lastQuestion&&c.methode.showSinglePage(0),3!==u.mode&&"number"!=typeof x.lastQuestion){f=n.eq(0).show();var s=f.find(C.questionList).data("question_id");A.questionStart(s)}A.startQuiz(),a.find(".wpProQuiz_sortable").parents("ul").sortable({update:function(i,t){var o=e(this).parents(".wpProQuiz_listItem");a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}}).disableSelection(),a.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable({connectWith:".wpProQuiz_maxtrixSortCriterion:not(:has(li)), .wpProQuiz_sortStringList",placeholder:"wpProQuiz_placehold",update:function(i,t){var o=e(this).parents(".wpProQuiz_listItem");a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}}).disableSelection(),m=[],L.start(),h=+new Date,p={comp:{points:0,correctQuestions:0,quizTime:0}},a.find(".wpProQuiz_questionList").each(function(){var i=e(this).data("question_id");p[i]={time:0}}),l={},e.each(t.catPoints,function(e,i){l[e]=0}),I.quizStartPage.hide(),a.find(".wpProQuiz_loadQuiz").hide(),I.quiz.show(),E.show(),0!==u.timelimitcookie&&(P="ld_"+u.quizId+"_quiz_responses",c.methode.CookieInit()),"1"===u.quiz_resume_enabled&&(P="ld_save_"+u.quizId+"_quiz_responses",c.methode.CookieInit()),c.methode.setupMatrixSortHeights(),3!=u.mode&&a.trigger({type:"changeQuestion",values:{item:f,index:f.index()}})}}},showSingleQuestion:function(e){var i=e?Math.ceil(e/u.qpp):1;3===u.mode&&"number"!=typeof x.lastQuestion?this.showSinglePage(i):this.singlePageNavigationQuizResume(i)},showSinglePage:function(e){if($listItem=I.questionList.children().hide(),u.qpp){e=e?+e:1;var i=Math.ceil(a.find(".wpProQuiz_list > li").length/u.qpp);if(!(e>i)){var t=a.find(C.singlePageLeft).hide(),o=a.find(C.singlePageRight).hide(),n=a.find('input[name="checkSingle"]').hide();e>1&&t.val(t.data("text").replace(/%d/,e-1)).show(),e==i?n.show():o.val(o.data("text").replace(/%d/,e+1)).show(),v=e;var s=u.qpp*(e-1);$listItem.slice(s,s+u.qpp).show(),c.methode.scrollTo(I.quizStartPage)}}else $listItem.show()},nextQuestion:function(){if(0===u.timelimitcookie&&"1"!==u.quiz_resume_enabled||(!0===f.find(C.next).data("question-lock")?c.methode.CookieProcessQuestionResponse(f,!0):c.methode.CookieProcessQuestionResponse(f)),"1"===u.quiz_resume_enabled){c.methode.saveMetaDataToCookie({lastQuestion:jQuery(f[0]).data("question-meta").question_pro_id});var e=jQuery(f.next()[0]);void 0!==e.data("question-meta")&&c.methode.saveMetaDataToCookie({nextQuestion:e.data("question-meta").question_pro_id})}jQuery(".mejs-pause").trigger("click"),this.showQuestionObject(f.next())},prevQuestion:function(){this.showQuestionObject(f.prev())},showQuestion:function(e){var i=I.listItems.eq(e);if(3==u.mode||w)return u.qpp&&c.methode.showSingleQuestion(e+1),c.methode.scrollTo(i,1),void A.startQuiz();this.showQuestionObject(i)},showQuestionObject:function(i){if(!i.length&&S.forcingQuestionSolve&&S.quizSummeryHide&&S.reviewQustion){list=I.questionList.children(),null!=list&&list.each(function(){var i=e(this),t=i.find(C.questionList);t.data("question_id"),u.json[t.data("question_id")]});for(var t=0,o=a.find(".wpProQuiz_listItem").length;t<o;t++)if(!m[t])return alert(WpProQuizGlobal.questionsNotSolved),!1}if(f.hide(),f=i.show(),c.methode.scrollTo(I.quiz),a.trigger({type:"changeQuestion",values:{item:f,index:f.index()}}),f.length){var n=f.find(C.questionList).data("question_id");A.questionStart(n)}else c.methode.showQuizSummary()},skipQuestion:function(){a.trigger({type:"skipQuestion",values:{item:f,index:f.index()}}),c.methode.nextQuestion()},reviewQuestion:function(){a.trigger({type:"reviewQuestion",values:{item:f,index:f.index()}})},uploadFile:function(i){var t=i.currentTarget.id.replace("uploadEssaySubmit_",""),o=e("#uploadEssay_"+t)[0].files[0];if(void 0!==o){var n=e("#_uploadEssay_nonce_"+t).val(),s=e("#uploadEssaySubmit_"+t),r=e("#uploadEssayMessage_"+t);r.removeClass("uploadEssayMessage_fail"),r.removeClass("uploadEssayMessage_success"),r.html(u.essayUploading);var d=new FormData;d.append("action","learndash_upload_essay"),d.append("nonce",n),d.append("question_id",t),d.append("course_id",u.course_id),d.append("essayUpload",o),e.ajax({method:"POST",type:"POST",url:WpProQuizGlobal.ajaxurl,data:d,cache:!1,contentType:!1,processData:!1,success:function(i){if(void 0!==i.data.message&&r.html(i.data.message),1==i.success&&void 0!==i.data.filelink){r.addClass("uploadEssayMessage_success"),e("#uploadEssayFile_"+t).val(i.data.filelink),s.attr("disabled","disabled");var o=e("#uploadEssayFile_"+t).parents(".wpProQuiz_listItem");a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}else r.addClass("uploadEssayMessage_fail"),s.removeAttr("disabled")}})}i.preventDefault()},showQuizSummary:function(){if(A.questionStop(),A.stopQuiz(),k=!0,!S.quizSummeryHide&&S.reviewQustion){var i=a.find(".wpProQuiz_checkPage");a.find(".wpProQuiz_checkPage .wpProQuiz_reviewSummary").append(a.find(".wpProQuiz_reviewDiv .wpProQuiz_reviewQuestion").clone()),a.find(".wpProQuiz_checkPage .wpProQuiz_reviewSummary").append(a.find(".wpProQuiz_reviewDiv .wpProQuiz_reviewLegend").clone()),a.find(".wpProQuiz_checkPage .wpProQuiz_reviewSummary .wpProQuiz_reviewQuestion li").removeClass("wpProQuiz_reviewQuestionTarget"),a.find(".wpProQuiz_checkPage .wpProQuiz_reviewSummary .wpProQuiz_reviewQuestion li").on("click",function(t){a.find(".wpProQuiz_checkPage .wpProQuiz_reviewSummary").html(""),i.hide(),I.quiz.show(),E.show(!0);var o=e(this).index();c.methode.showQuestion(o)});for(var t=0,o=0,n=m.length;o<n;o++)m[o]&&t++;i.find("span:eq(0)").text(t),E.hide(),I.quiz.hide(),i.show(),c.methode.scrollTo(i)}else S.formActivated&&u.formPos==T.END?(E.hide(),I.quiz.hide(),c.methode.scrollTo(a.find(".wpProQuiz_infopage").show())):c.methode.finishQuiz()},finishQuiz:function(e){I.next.last().attr("disabled","disabled"),a.find('input[name="checkSingle"]').attr("disabled","disabled"),A.questionStop(),A.stopQuiz(),L.stop(),k=!0;var i=(+new Date-h)/1e3;i=u.timelimit&&i>u.timelimit?u.timelimit:i,Q=i,a.find(".wpProQuiz_quiz_time span").text(c.methode.parseTime(i)),e&&I.results.find(".wpProQuiz_time_limit_expired").show(),c.methode.checkQuestion(I.questionList.children(),!0)},finishQuizEnd:function(){a.find(".wpProQuiz_correct_answer").text(p.comp.correctQuestions),p.comp.result=Math.round(p.comp.points/u.globalPoints*100*100)/100;var i=!1;if(e.each(p,function(){void 0!==this.graded_status&&"not_graded"==this.graded_status&&(i=!0)}),"undefined"!=typeof certificate_details&&null!=certificate_details.certificateLink&&""!=certificate_details.certificateLink){var o=a.find(".wpProQuiz_certificate");p.comp.result>=100*certificate_details.certificate_threshold?o.show():1==i&&"undefined"!=typeof certificate_pending&&(o.html(certificate_pending),o.show())}var n=a.find(".quiz_continue_link"),s=!1;jQuery(n).hasClass("show_quiz_continue_buttom_on_fail")&&(s=!0),void 0!==t.passingpercentage&&parseFloat(t.passingpercentage)>=0?p.comp.result>=t.passingpercentage||s?(a.addClass("ld-quiz-result-passed"),a.removeClass("ld-quiz-result-failed"),a.trigger({type:"learndash-quiz-finished",values:{status:"passed",item:a,results:p}}),a.trigger({type:"learndash-quiz-finished-passed",values:{status:"passed",item:a,results:p}}),"undefined"!=typeof continue_details&&(a.find(".quiz_continue_link").html(continue_details),a.find(".quiz_continue_link").show())):(a.removeClass("ld-quiz-result-passed"),a.addClass("ld-quiz-result-failed"),a.trigger({type:"learndash-quiz-finished",values:{status:"failed",item:a,results:p}}),a.trigger({type:"learndash-quiz-finished-failed",values:{status:"failed",item:a,results:p}}),a.find(".quiz_continue_link").hide()):"undefined"!=typeof continue_details&&(a.find(".quiz_continue_link").html(continue_details),a.find(".quiz_continue_link").show()),$pointFields=a.find(".wpProQuiz_points span"),$gradedPointsFields=a.find(".wpProQuiz_graded_points span"),$pointFields.eq(0).text(p.comp.points),$pointFields.eq(1).text(u.globalPoints),$pointFields.eq(2).text(p.comp.result+"%"),$gradedQuestionCount=0,$gradedQuestionPoints=0,e.each(p,function(e,i){if(!isNaN(e)&&i.graded_id){var t=i.possiblePoints-i.points;t>0&&($gradedQuestionPoints+=t,$gradedQuestionCount++)}}),$gradedQuestionCount>0&&(e(".wpProQuiz_points").hide(),e(".wpProQuiz_graded_points").show(),$gradedPointsFields.eq(0).text(p.comp.points),$gradedPointsFields.eq(1).text(u.globalPoints),$gradedPointsFields.eq(2).text(p.comp.result+"%"),$gradedPointsFields.eq(3).text($gradedQuestionCount),$gradedPointsFields.eq(4).text($gradedQuestionPoints)),a.find(".wpProQuiz_resultsList > li").eq(c.methode.findResultIndex(p.comp.result)).show(),c.methode.setAverageResult(p.comp.result,!1),this.setCategoryOverview(),c.methode.sendCompletedQuiz(),S.isAddAutomatic&&j.isUser&&c.methode.addToplist(),E.hide(),a.find(".wpProQuiz_checkPage, .wpProQuiz_infopage").hide(),I.quiz.hide()},sending:function(e,i,t){I.sending.show();var o,n=I.sending.find(".sending_progress_bar");if(o=void 0===typeof e||null==e?parseInt(100*n.width()/n.offsetParent().width())+156:e,null==i)i=80;null==t&&(t=1),null!=z&&void 0!==typeof z&&clearInterval(z),z=setInterval(function(){var e=parseInt(100*n.width()/n.offsetParent().width());e>=i&&(clearInterval(z),e>=100&&setTimeout(c.methode.showResults(),2e3)),n.css("width",o+"%"),o+=t},300)},showResults:function(){I.sending.hide(),I.results.show(),c.methode.scrollTo(I.results)},setCategoryOverview:function(){p.comp.cats={},a.find(".wpProQuiz_catOverview li").each(function(){var i=e(this),t=i.data("category_id");if(void 0===u.catPoints[t])return i.hide(),!0;var o=Math.round(l[t]/u.catPoints[t]*100*100)/100;p.comp.cats[t]=o,i.find(".wpProQuiz_catPercent").text(o+"%"),i.show()})},questionSolved:function(e){m[e.values.index]=e.values.solved},sendCompletedQuiz:function(){if(!S.preview){k=!0,R(p);var e=O.getFormData();if(void 0!==u.quiz_resume_data){var i=JSON.parse(u.quiz_resume_data);if(!jQuery.isEmptyObject(i))for(var t in i)if(t.startsWith("tip")){var o=i[t].question_id;p[o].tip=1}}if(void 0!==g&&""!==g)for(var t in g)if(t.startsWith("tip")){o=g[t].question_id;p[o].tip=1}jQuery.ajax({type:"POST",url:WpProQuizGlobal.ajaxurl,dataType:"json",cache:!1,data:{action:"wp_pro_quiz_completed_quiz",course_id:u.course_id,lesson_id:u.lesson_id,topic_id:u.topic_id,quiz:u.quiz,quizId:u.quizId,results:JSON.stringify(p),timespent:Q,forms:e,quiz_nonce:u.quiz_nonce},success:function(e){if(null!=e&&void 0!==u.quizId){var i=parseInt(u.quizId);void 0!==e[i]&&void 0!==e[i].quiz_result_settings&&(d=e[i].quiz_result_settings,c.methode.afterSendUpdateIU(d))}c.methode.sending(null,100,15),c.methode.CookieDelete()}})}},afterSendUpdateIU:function(e){void 0!==e.showAverageResult&&(e.showAverageResult||a.find(".wpProQuiz_resultTable").remove()),void 0!==e.showCategoryScore&&(e.showCategoryScore||a.find(".wpProQuiz_catOverview").remove()),void 0!==e.showRestartQuizButton&&(e.showRestartQuizButton||a.find('input[name="restartQuiz"]').remove()),void 0!==e.showResultPoints&&(e.showResultPoints||a.find(".wpProQuiz_points").remove()),void 0!==e.showResultQuizTime&&(e.showResultQuizTime||a.find(".wpProQuiz_quiz_time").remove()),void 0!==e.showViewQuestionButton&&(e.showViewQuestionButton||a.find('input[name="reShowQuestion"]').remove()),void 0!==e.showContinueButton&&(e.showContinueButton||a.find(".quiz_continue_link").remove())},findResultIndex:function(e){for(var i=u.resultsGrade,t=-1,o=999999,n=0;n<i.length;n++){var s=i[n];e>=s&&e-s<o&&(o=e-s,t=n)}return t},showQustionList:function(){w=!w,I.toplistShowInButton.hide(),I.quiz.toggle(),a.find(".wpProQuiz_QuestionButton").hide(),I.questionList.children().show(),E.toggle(),a.find(".wpProQuiz_question_page").hide()},random:function(i,t){var o;t=t||!1;i.each(function(){var i,t=e(this).data("type");i=""!==t&&"sort_answer"!==t?e(this).children().get().sort(function(){return Math.round(Math.random())-.5}):e(this).children().get(),e(i).appendTo(i[0].parentNode),o=i}),"1"===u.quiz_resume_enabled&&void 0!==o&&"question"===t&&c.methode.saveRandomQuestions(o)},saveRandomQuestions:function(e){var i=[];jQuery(e).each(function(e,t){jQuery(t).data("question-meta").type;var o=jQuery(t).data("question-meta").question_pro_id;i.push(o),setTimeout(function(){c.methode.saveMetaDataToCookie("randomQuestions"),c.methode.saveMetaDataToCookie("randomOrder",i)},500)})},sortCategories:function(){var i=e(".wpProQuiz_list").children().get().sort(function(i,t){var o=e(i).find(".wpProQuiz_questionList").data("question_id"),n=e(t).find(".wpProQuiz_questionList").data("question_id");return u.json[o].catId-u.json[n].catId});e(i).appendTo(i[0].parentNode)},restartQuiz:function(){I.results.hide(),I.questionList.children().hide(),I.toplistShowInButton.hide(),E.hide(),a.find(".wpProQuiz_questionInput, .wpProQuiz_cloze input").removeAttr("disabled").removeAttr("checked").css("background-color",""),a.find('.wpProQuiz_questionListItem input[type="text"]').val(""),a.find(".wpProQuiz_answerCorrect, .wpProQuiz_answerIncorrect").removeClass("wpProQuiz_answerCorrect wpProQuiz_answerIncorrect"),a.find(".wpProQuiz_listItem").data("check",!1),a.find("textarea.wpProQuiz_questionEssay").val(""),a.find("input.uploadEssayFile").val(""),a.find("input.wpProQuiz_upload_essay").val(""),a.find(".wpProQuiz_response").hide().children().hide(),c.methode.resetMatrix(a.find(".wpProQuiz_listItem")),a.find(".wpProQuiz_sortStringItem, .wpProQuiz_sortable").removeAttr("style"),a.find(".wpProQuiz_clozeCorrect, .wpProQuiz_QuestionButton, .wpProQuiz_resultsList > li").hide(),
a.find('.wpProQuiz_question_page, input[name="tip"]').show(),a.find(".wpProQuiz_certificate").attr("style","display: none !important"),I.results.find(".wpProQuiz_time_limit_expired").hide(),I.next.last().val(_),w=!1,window.location.reload(!0)},showSpinner:function(){a.find(".wpProQuiz_spinner").show()},hideSpinner:function(){a.find(".wpProQuiz_spinner").hide()},checkQuestion:function(i,t){var o=null!=i,n={};i=null==i?f:i,i.each(function(){var i=e(this),t=i.index(),o=i.find(C.questionList),s=o.data("question_id"),r=u.json[o.data("question_id")],a=r.type;if(A.questionStop(),i.data("check"))return!0;"single"!=r.type&&"multiple"!=r.type||(a="singleMulti"),n[s]=D(a,r,i,o,!0),n[s].question_pro_id=r.id,n[s].question_post_id=r.question_post_id,0===u.timelimitcookie&&"1"!==u.quiz_resume_enabled||c.methode.CookieSaveResponse(s,t,r.type,n[s],!0)}),u.checkAnswers={list:i,responses:n,endCheck:t,finishQuiz:o},o?c.methode.sending(1,80,3):c.methode.showSpinner(),c.methode.ajax({action:"ld_adv_quiz_pro_ajax",func:"checkAnswers",data:{quizId:u.quizId,quiz:u.quiz,course_id:u.course_id,quiz_nonce:u.quiz_nonce,responses:JSON.stringify(n)}},function(i){c.methode.hideSpinner();var t=u.checkAnswers.list,o=(u.checkAnswers.responses,u.checkAnswers.r,u.checkAnswers.endCheck,u.checkAnswers.finishQuiz);t.each(function(){var t=e(this),o=t.find(C.questionList),n=o.data("question_id");if(t.data("check"))return!0;if(void 0!==i[n]){var s=i[n];data=u.json[o.data("question_id")],t.find(".wpProQuiz_response").show(),t.find(C.check).hide(),t.find(C.skip).hide(),t.find(C.next).show(),t.find(C.next).attr("data-question-lock",!0),p[data.id].points=s.p,void 0!==s.p_nonce?p[data.id].p_nonce=s.p_nonce:p[data.id].p_nonce="",p[data.id].correct=Number(s.c),p[data.id].data=s.s,void 0!==s.a_nonce?p[data.id].a_nonce=s.a_nonce:p[data.id].a_nonce="",p[data.id].possiblePoints=s.e.possiblePoints,jQuery.isEmptyObject(p[data.id].data)&&(null==s.e.type||"sort_answer"!=s.e.type&&"matrix_sort_answer"!=s.e.type||(p[data.id].data=s.e.r)),void 0!==s.e.graded_id&&s.e.graded_id>0&&(p[data.id].graded_id=s.e.graded_id),void 0!==s.e.graded_status&&(p[data.id].graded_status=s.e.graded_status),p.comp.points+=s.p,t.find(".wpProQuiz_response").show(),t.find(C.check).hide(),t.find(C.skip).hide(),t.find(C.next).show(),t.find(C.next).attr("data-question-lock",!0),jQuery.isEmptyObject(p[data.id].data)&&void 0!==s.e.type&&("sort_answer"!=s.e.type&&"matrix_sort_answer"!=s.e.type||void 0!==s.e.r&&(p[data.id].data=s.e.r),"essay"==s.e.type&&void 0!==s.e.graded_id&&(p[data.id].data={graded_id:s.e.graded_id})),l[data.catId]+=s.p,"1"===u.quiz_resume_enabled&&c.methode.saveMetaDataToCookie("checked"+n,s),c.methode.markCorrectIncorrect(s,t,o),s.c?(void 0!==s.e.AnswerMessage&&(t.find(".wpProQuiz_correct").find(".wpProQuiz_AnswerMessage").html(s.e.AnswerMessage),t.find(".wpProQuiz_correct").trigger("learndash-quiz-answer-response-contentchanged")),a.trigger({type:"questionSolvedCorrect",values:{item:t,index:t.index(),solved:!0,result:s}}),t.find(".wpProQuiz_correct").show(),p.comp.correctQuestions+=1):(void 0!==s.e.AnswerMessage&&(t.find(".wpProQuiz_incorrect").find(".wpProQuiz_AnswerMessage").html(s.e.AnswerMessage),t.find(".wpProQuiz_incorrect").trigger("learndash-quiz-answer-response-contentchanged")),a.trigger({type:"questionSolvedIncorrect",values:{item:t,index:t.index(),solved:!0,result:s}}),t.find(".wpProQuiz_incorrect").show()),t.find(".wpProQuiz_responsePoints").text(s.p),t.data("check",!0)}}),o&&c.methode.finishQuizEnd()})},markCorrectIncorrect:function(i,t,o){if(void 0!==i.e.c)switch(i.e.type){case"single":case"multiple":o.children().each(function(t){var o=e(this),n=o.attr("data-pos");if(i.e.c[n]){var s=e("input.wpProQuiz_questionInput",o).is(":checked");s?c.methode.marker(o,!0):c.methode.marker(o,"wpProQuiz_answerCorrectIncomplete")}else!i.c&&i.e.r[n]&&c.methode.marker(o,!1)});break;case"free_answer":var n=o.children();i.c?c.methode.marker(n,!0):c.methode.marker(n,!1),void 0!==i.e.c&&void 0!==i.e.c&&i.e.c.length>0&&t.find("span.wpProQuiz_freeCorrect").html(i.e.c.join(", ")).show();break;case"cloze_answer":o.find(".wpProQuiz_cloze").each(function(t,o){var n=e(this),s=n.children(),r=s.eq(0),a=s.eq(1);c.methode.cleanupCurlyQuotes(r.val());i.s[t]?r.addClass("wpProQuiz_answerCorrect"):(r.addClass("wpProQuiz_answerIncorrect"),void 0!==i.e.c[t]&&(a.html("("+i.e.c[t].join()+")"),a.show())),r.attr("disabled","disabled")});break;case"sort_answer":var s=o.clone();s.insertAfter(o),s.addClass("wpProQuiz_questionList_correct");var r=s.children("li.wpProQuiz_questionListItem"),a=new Array;jQuery.each(i.e.c,function(e,i){a[i]=e}),r.sort(function(i,t){return a[e(i).attr("data-pos")]>a[e(t).attr("data-pos")]?1:-1}),s.append(r),s.children("li.wpProQuiz_questionListItem").addClass("wpProQuiz_answerCorrect"),jQuery.each(i.e.c,function(e,i){var t=o.children("li.wpProQuiz_questionListItem")[e];void 0!==t&&""!==t&&(i==jQuery(t).data("pos")?c.methode.marker(jQuery(t),!0):c.methode.marker(jQuery(t),!1))});var u=jQuery("div.wpProQuiz_questionList_containers");void 0!==u&&(jQuery(u).find(".wpProQuiz_questionList_container_student").append(o),jQuery(u).find(".wpProQuiz_questionList_container_correct").append(s),jQuery(u).find(".wpProQuiz_questionList_container_student").show(),jQuery(u).find(".wpProQuiz_questionList_container_correct").hide(),jQuery(u).find("input.wpProQuiz_questionList_containers_view_student").on("click",function(e){jQuery(u).find("input.wpProQuiz_questionList_containers_view_student").addClass("wpProQuiz_questionList_containers_view_active"),jQuery(u).find("input.wpProQuiz_questionList_containers_view_correct").removeClass("wpProQuiz_questionList_containers_view_active"),jQuery(u).find(".wpProQuiz_questionList_container_correct").hide(),jQuery(u).find(".wpProQuiz_questionList_container_student").show(),e.preventDefault()}),jQuery(u).find("input.wpProQuiz_questionList_containers_view_correct").on("click",function(e){jQuery(u).find("input.wpProQuiz_questionList_containers_view_student").removeClass("wpProQuiz_questionList_containers_view_active"),jQuery(u).find("input.wpProQuiz_questionList_containers_view_correct").addClass("wpProQuiz_questionList_containers_view_active"),jQuery(u).find(".wpProQuiz_questionList_container_student").hide(),jQuery(u).find(".wpProQuiz_questionList_container_correct").show(),e.preventDefault()}),jQuery(u).show());break;case"matrix_sort_answer":r=o.children();var d=new Array;statistcAnswerData={0:-1},r.each(function(){var t=e(this),o=(t.attr("data-pos"),t.find(".wpProQuiz_maxtrixSortCriterion")),n=o.children(),s=n.attr("data-pos");n.length&&i.e.c[s]==t.attr("data-pos")?c.methode.marker(t,!0):c.methode.marker(t,!1),d[s]=o}),c.methode.resetMatrix(t),t.find(".wpProQuiz_sortStringItem").each(function(){var i=d[e(this).attr("data-pos")];null!=i&&i.append(this)}).css({"box-shadow":"0 0",cursor:"auto"}),t.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable(),t.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable("destroy")}},setCheckedStatusFromData:function(e,i,t){var o=[x,g];jQuery(o).each(function(o,n){if(n.hasOwnProperty("checked"+e.id))for(var s in n)if(s.startsWith("checked")){var r=s.replace("checked","");r==e.id&&(questionResult=n[s],c.methode.markCorrectIncorrect(questionResult,i,t),questionResult.c?(void 0!==questionResult.e.AnswerMessage&&(i.find(".wpProQuiz_correct").find(".wpProQuiz_AnswerMessage").html(questionResult.e.AnswerMessage),i.find(".wpProQuiz_correct").trigger("learndash-quiz-answer-response-contentchanged")),i.find(".wpProQuiz_response").show(),i.find(".wpProQuiz_correct").show()):(void 0!==questionResult.e.AnswerMessage&&(i.find(".wpProQuiz_incorrect").find(".wpProQuiz_AnswerMessage").html(questionResult.e.AnswerMessage),i.find(".wpProQuiz_incorrect").trigger("learndash-quiz-answer-response-contentchanged")),i.find(".wpProQuiz_response").show(),i.find(".wpProQuiz_incorrect").show()))}})},showTip:function(){var i=e(this),t=i.siblings(".wpProQuiz_question").find(C.questionList).data("question_id");i.siblings(".wpProQuiz_tipp").toggle("fast"),p[t].tip=1,"1"===u.quiz_resume_enabled&&c.methode.saveMetaDataToCookie("tip"+t,{question_id:t}),e(document).on("mouseup.tipEvent",function(i){var t=a.find(".wpProQuiz_tipp"),o=a.find('input[name="tip"]');t.is(i.target)||0!=t.has(i.target).length||o.is(i.target)||(t.hide("fast"),e(document).unbind(".tipEvent"))})},ajax:function(i,t,o){o=o||"json",S.cors&&(jQuery.support.cors=!0),void 0===i.quiz&&(i.quiz=u.quiz),void 0===i.course_id&&(i.course_id=u.course_id),void 0===i.quiz_nonce&&(i.quiz_nonce=u.quiz_nonce),e.ajax({method:"POST",type:"POST",url:WpProQuizGlobal.ajaxurl,data:i,success:t,dataType:o}),S.cors&&(jQuery.support.cors=!1)},checkQuizLock:function(){b.loadLock=1,c.methode.ajax({action:"wp_pro_quiz_check_lock",quizId:u.quizId},function(e){null!=e.lock&&(b.isLocked=e.lock.is),null!=e.prerequisite&&(b.isPrerequisite=1,a.find(".wpProQuiz_prerequisite span").text(e.prerequisite)),null!=e.startUserLock&&(b.isUserStartLocked=e.startUserLock),b.loadLock=0,b.isQuizStart&&c.methode.startQuiz()})},loadQuizData:function(){c.methode.ajax({action:"wp_pro_quiz_load_quiz_data",quizId:u.quizId,quiz_nonce:u.quiz_nonce},function(e){e.toplist&&c.methode.handleToplistData(e.toplist),null!=e.averageResult&&c.methode.setAverageResult(e.averageResult,!0)})},setAverageResult:function(e,i){var t=a.find(".wpProQuiz_resultValue:eq("+(i?0:1)+") > * ");t.eq(1).text(e+"%"),t.eq(0).css("width",240*e/100+"px")},handleToplistData:function(e){var i=a.find(".wpProQuiz_addToplist"),t=i.find(".wpProQuiz_addBox").show().children("div");if(e.canAdd)if(i.show(),i.find(".wpProQuiz_addToplistMessage").hide(),i.find(".wpProQuiz_toplistButton").show(),j.token=e.token,j.isUser=0,e.userId)t.hide(),j.isUser=1,S.isAddAutomatic&&i.hide();else{t.show();var o=t.children().eq(1);e.captcha?(o.find('input[name="wpProQuiz_captchaPrefix"]').val(e.captcha.code),o.find(".wpProQuiz_captchaImg").attr("src",e.captcha.img),o.find('input[name="wpProQuiz_captcha"]').val(""),o.show()):o.hide()}else i.hide()},scrollTo:function(i,t){var o=i.offset().top-100;(t||(window.pageYOffset||document.body.scrollTop)>o)&&e("html,body").clearQueue().animate({scrollTop:o},300)},addToplist:function(){if(!S.preview){var e=a.find(".wpProQuiz_addToplistMessage").text(WpProQuizGlobal.loadData).show(),i=a.find(".wpProQuiz_addBox").hide();c.methode.ajax({action:"wp_pro_quiz_add_toplist",quizId:u.quizId,quiz:u.quiz,quiz_nonce:u.quiz_nonce,token:j.token,name:i.find('input[name="wpProQuiz_toplistName"]').val(),email:i.find('input[name="wpProQuiz_toplistEmail"]').val(),captcha:i.find('input[name="wpProQuiz_captcha"]').val(),prefix:i.find('input[name="wpProQuiz_captchaPrefix"]').val(),results:p,timespent:Q},function(t){e.text(t.text),t.clear?(i.hide(),c.methode.updateToplist()):i.show(),t.captcha&&(i.find(".wpProQuiz_captchaImg").attr("src",t.captcha.img),i.find('input[name="wpProQuiz_captchaPrefix"]').val(t.captcha.code),i.find('input[name="wpProQuiz_captcha"]').val(""))})}},updateToplist:function(){"function"==typeof wpProQuiz_fetchToplist&&wpProQuiz_fetchToplist()},registerSolved:function(){a.find('.wpProQuiz_questionInput[type="text"]').on("change",function(i){var t=e(this),o=t.parents(".wpProQuiz_listItem"),n=!1;""!=t.val()&&(n=!0),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:n}})}),a.find('.wpProQuiz_questionList[data-type="single"] .wpProQuiz_questionInput, .wpProQuiz_questionList[data-type="assessment_answer"] .wpProQuiz_questionInput').on("change",function(i){var t=e(this),o=t.parents(".wpProQuiz_listItem"),n=this.checked;a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:n}})}),a.find(".wpProQuiz_cloze input").on("change",function(){var i=e(this),t=i.parents(".wpProQuiz_listItem"),o=!0;t.find(".wpProQuiz_cloze input").each(function(){if(""==e(this).val())return o=!1,!1}),a.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:o}})}),a.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').on("change",function(i){var t=e(this),o=t.parents(".wpProQuiz_listItem"),n=0;o.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').each(function(e){this.checked&&n++}),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!!n}})}),a.find('.wpProQuiz_questionList[data-type="essay"] textarea.wpProQuiz_questionEssay').on("change",function(i){var t=e(this),o=t.parents(".wpProQuiz_listItem"),n=!1;""!=t.val()&&(n=!0),a.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:n}})})},loadQuizDataAjax:function(i){c.methode.ajax({action:"wp_pro_quiz_admin_ajax_load_data",func:"quizLoadData",data:{quizId:u.quizId,quiz:u.quiz,quiz_nonce:u.quiz_nonce}},function(t){u.globalPoints=t.globalPoints,u.catPoints=t.catPoints,u.json=t.json,I.quiz.remove(),a.find(".wpProQuiz_quizAnker").after(t.content),e("table.wpProQuiz_toplistTable caption span.wpProQuiz_max_points").html(u.globalPoints),I={back:a.find('input[name="back"]'),next:a.find(C.next),quiz:a.find(".wpProQuiz_quiz"),questionList:a.find(".wpProQuiz_list"),results:a.find(".wpProQuiz_results"),sending:a.find(".wpProQuiz_sending"),quizStartPage:a.find(".wpProQuiz_text"),timelimit:a.find(".wpProQuiz_time_limit"),toplistShowInButton:a.find(".wpProQuiz_toplistShowInButton"),listItems:e()},c.methode.initQuiz(),i&&c.methode.startQuiz(!0);var o=t.content,n=o.search("wp-audio-shortcode"),s=o.search("wp-video-shortcode");"-1"==n&&"-1"==s||(e.getScript(t.site_url+"/wp-includes/js/mediaelement/mediaelement-and-player.min.js"),e.getScript(t.site_url+"/wp-includes/js/mediaelement/wp-mediaelement.js"),e("<link/>",{rel:"stylesheet",type:"text/css",href:t.site_url+"/wp-includes/js/mediaelement/mediaelementplayer.min.css"}).appendTo("head"))})},nextQuestionClicked:function(){var e=f.find(C.questionList);u.json[e.data("question_id")];if(S.forcingQuestionSolve&&!m[f.index()]&&(S.quizSummeryHide||!S.reviewQustion))return alert(WpProQuizGlobal.questionNotSolved),!1;c.methode.nextQuestion()},initQuiz:function(){c.methode.setClozeStyle(),c.methode.registerSolved(),I.next.on("click",c.methode.nextQuestionClicked),I.back.on("click",function(){c.methode.prevQuestion()}),a.find(C.check).on("click",function(){if(S.forcingQuestionSolve&&!m[f.index()])return alert(WpProQuizGlobal.questionNotSolved),!1;c.methode.checkQuestion()}),a.find('input[name="checkSingle"]').on("click",function(){var i=I.questionList.children();if(null!=i&&i.each(function(){var i=e(this),t=i.find(C.questionList);t.data("question_id"),u.json[t.data("question_id")]}),S.forcingQuestionSolve&&(S.quizSummeryHide||!S.reviewQustion))for(var t=0,o=a.find(".wpProQuiz_listItem").length;t<o;t++)if(!m[t])return alert(WpProQuizGlobal.questionsNotSolved),!1;c.methode.showQuizSummary()}),a.find('input[name="tip"]').on("click",c.methode.showTip),a.find('input[name="skip"]').on("click",c.methode.skipQuestion),a.find('input[name="wpProQuiz_pageLeft"]').on("click",function(){c.methode.showSinglePage(v-1),c.methode.setupMatrixSortHeights()}),a.find('input[name="wpProQuiz_pageRight"]').on("click",function(){c.methode.showSinglePage(v+1),c.methode.setupMatrixSortHeights()}),a.find('input[id^="uploadEssaySubmit"]').on("click",c.methode.uploadFile),a.trigger("learndash-quiz-init")},CookieInit:function(){g=jQuery.cookie(P),g=g&&null!=g&&"%7B%7D"!==g?JSON.parse(g):{},S.formActivated&&u.formPos===T.START&&O.checkForm()&&O.saveFormDataToCookie(),c.methode.CookieSetResponses(),c.methode.CookieResponseTimer()},CookieDelete:function(){jQuery.cookie(P,"")},CookieProcessQuestionResponse:function(i,t){t=t||!1;null!=i&&i.each(function(){var i=e(this),o=i.index(),n=i.find(C.questionList),s=n.data("question_id"),r=u.json[n.data("question_id")],a=r.type;"single"!=r.type&&"multiple"!=r.type||(a="singleMulti");var d=D(a,r,i,n,!1);c.methode.saveMetaDataToCookie({lastQuestion:s}),c.methode.CookieSaveResponse(s,o,r.type,d,t)})},CookieSaveResponse:function(e,i,t,o,n){n=n||!1;g[e]=e==="formData"+i?{index:i,value:o,type:t}:{index:i,value:o.response,type:t,lockQuestion:n},c.methode.calculateCookieExpiry(),jQuery.cookie(P,JSON.stringify(g),{expires:y}),"1"!==u.quiz_resume_enabled||q||c.methode.startCookieSendTimer()},calculateCookieExpiry:function(){y=new Date,u.timelimitcookie&&!u.quiz_resume_cookie_expiration&&y.setTime(y.getTime()+1e3*u.timelimitcookie),u.quiz_resume_cookie_expiration&&!u.timelimitcookie&&y.setTime(y.getTime()+1e3*u.quiz_resume_cookie_expiration)},saveMetaDataToCookie:function(e,i){i=i||!1;if(c.methode.calculateCookieExpiry(),"string"==typeof e&&"object"==typeof i)for(var t in g[e]={},i){var o={[t]:i[t]};Object.assign(g[e],o)}else if("string"!=typeof e||i){if("object"==typeof e)for(var t in e)g[t]=e[t]}else g[e]=!0;jQuery.cookie(P,JSON.stringify(g),{expires:y}),u.quiz_resume_enabled&&!q&&c.methode.startCookieSendTimer()},CookieResponseTimer:function(){a.on("questionSolved",function(e){0===u.timelimitcookie&&"1"!==u.quiz_resume_enabled||c.methode.CookieProcessQuestionResponse(e.values.item)})},CookieSetResponses:function(){if(null!=g&&Object.keys(g).length||u.quiz_resume_id){var i=I.questionList.children();i.each(function(){var i=e(this),t=i.find(C.questionList),o=t.data("question_id");if(null!=x[o]){var s=x[o],r=u.json[t.data("question_id")];r.type===s.type&&n(r,s.value,i,t,s.lockQuestion)}if(null!=g[o]){var a=g[o];r=u.json[t.data("question_id")];r.type===a.type&&n(r,a.value,i,t,a.lockQuestion)}void 0!==x&&void 0!==g&&(void 0!==g.nextQuestion&&g.nextQuestion?c.methode.moveToNextUnansweredQuestion(g):c.methode.moveToNextUnansweredQuestion(x))})}},startCookieSendTimer:function(){q||void 0!==x&&0!==x.length||c.methode.prepareSendCookieData(),q=!0,setInterval(function(){k||c.methode.prepareSendCookieData()},1e3*u.quiz_resume_cookie_send_timer)},prepareSendCookieData:function(){u.timelimit&&c.methode.addTimelimitCookieData();var e=c.methode.getObjectLength(g);if(e>0){var i=c.methode.getObjectKeys(g);k=!0,c.methode.sendCookieData(i)}},getObjectLength:function(e){return Object.keys(e).length},getObjectKeys:function(e){return Object.keys(e)},excludeKeysFromCount:function(e,i){var t=c.methode.getObjectKeys(e),o=0;return t.forEach(function(e){e.startsWith(i)||o++}),o},addTimelimitCookieData:function(){var e=jQuery.cookie(L.timer_cookie);void 0!==e&&c.methode.saveMetaDataToCookie({[L.timer_cookie]:JSON.parse(e)})},moveToNextUnansweredQuestion:function(i){if(void 0!==i){var t="number"==typeof i.nextQuestion?i.nextQuestion:0,o="number"==typeof i.lastQuestion?i.lastQuestion:0;3===u.mode&&(u.qpp?jQuery(I.listItems).each(function(i,t){e(t).data("question-meta").question_pro_id===o&&c.methode.singlePageNavigationQuizResume(i)}):(jQuery(I.questionList).children().show(),jQuery(I.listItems).each(function(i,t){e(t).data("question-meta").question_pro_id===o&&c.methode.scrollTo(I.listItems.eq(i),1)}))),3!==u.mode&&jQuery(I.listItems).each(function(i,o){if(e(o).data("question-meta").question_pro_id===t){f=I.listItems.eq(i);var n=f.find(C.questionList).data("question_id");A.questionStart(n),c.methode.showQuestionObject(f)}})}},singlePageNavigationQuizResume:function(e){var i=e+1,t=Math.ceil(a.find(".wpProQuiz_list > li").length/u.qpp),o=Math.ceil(i/u.qpp);if(o<=t){var n=I.questionList.children().hide(),s=a.find(C.singlePageLeft).hide(),r=a.find(C.singlePageRight).hide(),d=a.find('input[name="checkSingle"]').hide();o>1&&s.val(s.data("text").replace(/%d/,o-1)).show(),o===t?d.show():r.val(r.data("text").replace(/%d/,o+1)).show(),v=o;var p=u.qpp*(o-1);n.slice(p,p+u.qpp).show(),c.methode.scrollTo(I.listItems.eq(e),1)}},sendCookieData:function(e){jQuery.ajax({type:"POST",url:WpProQuizGlobal.ajaxurl,dataType:"json",cache:!1,data:{action:"wp_pro_quiz_cookie_save_quiz",course_id:u.course_id,quiz:u.quiz,quizId:u.quizId,quiz_started:A.getQuizStart(),results:JSON.stringify(g),quiz_nonce:u.quiz_nonce},success:function(i){i.success&&(c.methode.compareObjectKeys(i.data,g)&&c.methode.deleteCookieKeys(e),k=!1)},error:function(e){var i=JSON.parse(e.responseText);console.log(i.data.message),alert(i.data.message),k=!1}})},compareObjectKeys:function(e,i){var t=Object.keys(e).sort(),o=Object.keys(i).sort();return JSON.stringify(t)===JSON.stringify(o)},deleteCookieKeys:function(e){e.forEach(function(e){delete g[e]}),jQuery.cookie(P,JSON.stringify(g),{expires:y})},setupMatrixSortHeights:function(){e("li.wpProQuiz_listItem",I.questionList).each(function(i,t){var o=e(t).data("type");if("matrix_sort_answer"===o){var n=0;e("ul.wpProQuiz_sortStringList li",t).each(function(i,t){var o=e(t).outerHeight();o>n&&(n=o)}),n>0&&e("ul.wpProQuiz_sortStringList",t).css("min-height",n),e("ul.wpProQuiz_maxtrixSortCriterion",t).each(function(i,t){var o=e(t).parent("td");if(void 0!==o){var n=e(o).height();n&&(e(t).css("height",n),e(t).css("min-height",n))}})}})}},c.preInit=function(){c.methode.parseBitOptions(),E.init(),a.find('input[name="startQuiz"]').on("click",function(){return c.methode.startQuiz(),!1}),S.checkBeforeStart&&!S.preview&&c.methode.checkQuizLock(),a.find('input[name="reShowQuestion"]').on("click",function(){c.methode.showQustionList()}),a.find('input[name="restartQuiz"]').on("click",function(){c.methode.restartQuiz()}),a.find('input[name="review"]').on("click",c.methode.reviewQuestion),a.find('input[name="wpProQuiz_toplistAdd"]').on("click",c.methode.addToplist),a.find('input[name="quizSummary"]').on("click",c.methode.showQuizSummary),a.find('input[name="endQuizSummary"]').on("click",function(){if(S.forcingQuestionSolve){list=I.questionList.children(),null!=list&&list.each(function(){var i=e(this),t=i.find(C.questionList);t.data("question_id"),u.json[t.data("question_id")]});for(var i=0,t=a.find(".wpProQuiz_listItem").length;i<t;i++)if(!m[i])return alert(WpProQuizGlobal.questionsNotSolved),!1}S.formActivated&&u.formPos==T.END&&!O.checkForm()||c.methode.finishQuiz()}),a.find('input[name="endInfopage"]').on("click",function(){O.checkForm()&&c.methode.finishQuiz()}),a.find('input[name="showToplist"]').on("click",function(){I.quiz.hide(),I.toplistShowInButton.toggle()}),a.on("questionSolved",c.methode.questionSolved),S.maxShowQuestion||c.methode.initQuiz(),S.autoStart&&c.methode.startQuiz(),S.formActivated&&u.formPos===T.START&&O.setFormDataFromServer()},c.preInit()},e.fn.wpProQuizFront=function(i){return this.each(function(){null==e(this).data("wpProQuizFront")&&e(this).data("wpProQuizFront",new e.wpProQuizFront(this,i))})}})(jQuery);